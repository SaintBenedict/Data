<?xml version="1.0" encoding="utf-8" ?>
<Defs>

  <!-- Psychic sensitizer -->

  <HediffDef ParentName="ImplantHediffBase">
    <defName>PsychicSensitizer</defName>
    <label>psychic sensitizer</label>
    <labelNoun>a psychic sensitizer</labelNoun>
    <description>An installed psychic sensitizer implant.</description>
    <descriptionHyperlinks><ThingDef>PsychicSensitizer</ThingDef></descriptionHyperlinks>
    <spawnThingOnRemoved>PsychicSensitizer</spawnThingOnRemoved>
    <stages>
      <li>
        <statOffsets>
          <PsychicSensitivity>0.25</PsychicSensitivity>
        </statOffsets>
      </li>
    </stages>
  </HediffDef>

  <ThingDef ParentName="BodyPartRoyalBase">
    <defName>PsychicSensitizer</defName>
    <label>psychic sensitizer</label>
    <description>This brain implant stimulates growth in the regions of the brain related to psychic interaction, thus increasing psychic sensitivity.</description>
    <descriptionHyperlinks><RecipeDef>InstallPsychicSensitizer</RecipeDef></descriptionHyperlinks>
    <statBases>
      <MarketValue>1000</MarketValue>
    </statBases>
  </ThingDef>

  <RecipeDef ParentName="SurgeryInstallImplantBase">
    <defName>InstallPsychicSensitizer</defName>
    <label>install psychic sensitizer</label>
    <description>Install a psychic sensitizer.</description>
    <descriptionHyperlinks><ThingDef>PsychicSensitizer</ThingDef></descriptionHyperlinks>
    <jobString>Installing psychic sensitizer.</jobString>
    <ingredients>
      <li>
        <filter>
          <thingDefs>
            <li>PsychicSensitizer</li>
          </thingDefs>
        </filter>
        <count>1</count>
      </li>
    </ingredients>
    <fixedIngredientFilter>
      <thingDefs>
        <li>PsychicSensitizer</li>
      </thingDefs>
    </fixedIngredientFilter>
    <appliedOnFixedBodyParts>
      <li>Brain</li>
    </appliedOnFixedBodyParts>
    <addsHediff>PsychicSensitizer</addsHediff>
  </RecipeDef>
  
  <RecipeDef ParentName="SurgeryRemoveImplantBase">
    <defName>RemovePsychicSensitizer</defName>
    <label>remove psychic sensitizer</label>
    <description>Remove psychic sensitizer.</description>
    <descriptionHyperlinks><ThingDef>PsychicSensitizer</ThingDef></descriptionHyperlinks>
    <jobString>Removing psychic sensitizer.</jobString>
    <removesHediff>PsychicSensitizer</removesHediff>
  </RecipeDef>

  <!-- Psychic harmonizer -->

  <ThoughtDef>
    <defName>PsychicHarmonization</defName>
    <thoughtClass>Thought_PsychicHarmonizer</thoughtClass>
    <effectMultiplyingStat>PsychicSensitivity</effectMultiplyingStat>
    <stackLimit>100</stackLimit>
    <stages>
      <li>
        <label>psychic harmony: {HARMONIZER_labelShort}</label>
        <description>The psychic harmonizer implant makes me feel some of the emotions of the person using it as long as we're close together.</description>
        <baseMoodEffect>8</baseMoodEffect>
      </li>
    </stages>
  </ThoughtDef>

  <HediffDef ParentName="ImplantHediffBase">
    <defName>PsychicHarmonizer</defName>
    <label>psychic harmonizer</label>
    <labelNoun>a psychic harmonizer</labelNoun>
    <description>An installed psychic harmonizer implant.</description>
    <descriptionHyperlinks><ThingDef>PsychicHarmonizer</ThingDef></descriptionHyperlinks>
    <spawnThingOnRemoved>PsychicHarmonizer</spawnThingOnRemoved>
    <comps>
      <li Class="HediffCompProperties_PsychicHarmonizer">
        <range>30</range>
        <thought>PsychicHarmonization</thought>
      </li>
    </comps>
  </HediffDef>

  <ThingDef ParentName="BodyPartRoyalBase">
    <defName>PsychicHarmonizer</defName>
    <label>psychic harmonizer</label>
    <description>This brain implant projects the user's mood in a spherical psychic field, forcing others nearby to feel a blurred, simplified version of their emotions. It can be an powerful tool to keep morale high, but if the user becomes unhappy, it can lead to collective disaster.</description>
    <descriptionHyperlinks><RecipeDef>InstallPsychicHarmonizer</RecipeDef></descriptionHyperlinks>
    <statBases>
      <MarketValue>800</MarketValue>
    </statBases>
  </ThingDef>

  <RecipeDef ParentName="SurgeryInstallImplantBase">
    <defName>InstallPsychicHarmonizer</defName>
    <label>install psychic harmonizer</label>
    <description>Install a psychic harmonizer.</description>
    <descriptionHyperlinks><ThingDef>PsychicHarmonizer</ThingDef></descriptionHyperlinks>
    <jobString>Installing psychic harmonizer.</jobString>
    <ingredients>
      <li>
        <filter>
          <thingDefs>
            <li>PsychicHarmonizer</li>
          </thingDefs>
        </filter>
        <count>1</count>
      </li>
    </ingredients>
    <fixedIngredientFilter>
      <thingDefs>
        <li>PsychicHarmonizer</li>
      </thingDefs>
    </fixedIngredientFilter>
    <appliedOnFixedBodyParts>
      <li>Brain</li>
    </appliedOnFixedBodyParts>
    <addsHediff>PsychicHarmonizer</addsHediff>
  </RecipeDef>

  <RecipeDef ParentName="SurgeryRemoveImplantBase">
    <defName>RemovePsychicHarmonizer</defName>
    <label>remove psychic harmonizer</label>
    <description>Remove psychic harmonizer.</description>
    <descriptionHyperlinks><ThingDef>PsychicHarmonizer</ThingDef></descriptionHyperlinks>
    <jobString>Removing psychic harmonizer.</jobString>
    <removesHediff>PsychicHarmonizer</removesHediff>
  </RecipeDef>

  <!-- Psychic reader -->

  <HediffDef ParentName="ImplantHediffBase">
    <defName>PsychicReader</defName>
    <label>psychic reader</label>
    <labelNoun>a psychic reader</labelNoun>
    <description>An installed psychic reader implant.</description>
    <descriptionHyperlinks><ThingDef>PsychicReader</ThingDef></descriptionHyperlinks>
    <spawnThingOnRemoved>PsychicReader</spawnThingOnRemoved>
    <stages>
      <li>
        <statOffsets>
          <NegotiationAbility>0.5</NegotiationAbility>
        </statOffsets>
        <statOffsetEffectMultiplier>PsychicSensitivity</statOffsetEffectMultiplier>
      </li>
    </stages>
  </HediffDef>

  <ThingDef ParentName="BodyPartRoyalBase">
    <defName>PsychicReader</defName>
    <label>psychic reader</label>
    <description>Gives limited mind-reading ability, improving the user’s ability to get the upper hand in negotiations and social situations. The effect is proportional to the user’s psychic sensitivity.</description>
    <descriptionHyperlinks><RecipeDef>InstallPsychicReader</RecipeDef></descriptionHyperlinks>
    <statBases>
      <MarketValue>1000</MarketValue>
    </statBases>
  </ThingDef>

  <RecipeDef ParentName="SurgeryInstallImplantBase">
    <defName>InstallPsychicReader</defName>
    <label>install psychic reader</label>
    <description>Install a psychic reader.</description>
    <descriptionHyperlinks><ThingDef>PsychicReader</ThingDef></descriptionHyperlinks>
    <jobString>Installing psychic reader.</jobString>
    <ingredients>
      <li>
        <filter>
          <thingDefs>
            <li>PsychicReader</li>
          </thingDefs>
        </filter>
        <count>1</count>
      </li>
    </ingredients>
    <fixedIngredientFilter>
      <thingDefs>
        <li>PsychicReader</li>
      </thingDefs>
    </fixedIngredientFilter>
    <appliedOnFixedBodyParts>
      <li>Brain</li>
    </appliedOnFixedBodyParts>
    <addsHediff>PsychicReader</addsHediff>
  </RecipeDef>
  
  <RecipeDef ParentName="SurgeryRemoveImplantBase">
    <defName>RemovePsychicReader</defName>
    <label>remove psychic reader</label>
    <description>Remove psychic reader.</description>
    <descriptionHyperlinks><ThingDef>PsychicReader</ThingDef></descriptionHyperlinks>
    <jobString>Removing psychic reader.</jobString>
    <removesHediff>PsychicReader</removesHediff>
  </RecipeDef>

  <!-- Psychic amplifier -->

  <ThingDef ParentName="BodyPartRoyalBase">
    <defName>PsychicAmplifier</defName>
    <label>psychic amplifier</label>
    <description>An archotech device that links the brain to a larger psychic field. With training in specific abilities, the user can throw psycasts with diverse effects.
\nThis implant can be upgraded through several levels. Higher levels permit the use of more powerful psycasts.
\nThe psychic amplifier can be self-installed by one person with no chance of failure. The user presses the unit into their skull, where it inserts its neural tendrils and binds itself to the bone. Removing it requires a surgeon.
\nImperial laws restrict the use of the psychic amplifer to specific royal titles. Illegal use of the amplifier runs the risk of having your psychic signature detected and causing diplomatic consequences.</description>
    <thingSetMakerTags>
      <li>RewardStandardHighFreq</li>
      <li>RewardNonEmpireFactionsOnly</li>
    </thingSetMakerTags>
    <statBases>
      <MarketValue>1200</MarketValue>
    </statBases>
    <graphicData>
      <texPath>Things/Item/Special/PsychicAmplifier</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <color>(1,1,1)</color>
    </graphicData>
    <comps>
      <li Class="CompProperties_RoyalImplant">
        <implantHediff>PsychicAmplifier</implantHediff>
      </li>
      <li Class="CompProperties_Usable">
        <compClass>CompUsableImplant</compClass>
        <useJob>UseItem</useJob>
        <useLabel>Install psychic amplifier</useLabel>
      </li>
      <li Class="CompProperties_UseEffectInstallImplant">
        <hediffDef>PsychicAmplifier</hediffDef>
        <bodyPart>Brain</bodyPart>
        <canUpgrade>true</canUpgrade>
      </li>
      <li Class="CompProperties_UseEffect">
        <compClass>CompUseEffect_DestroySelf</compClass>
      </li>
    </comps>
  </ThingDef>
  
  <HediffDef ParentName="ImplantHediffBase">
    <defName>PsychicAmplifier</defName>
    <hediffClass>Hediff_PsychicAmplifier</hediffClass>
    <descriptionHyperlinks><ThingDef>PsychicAmplifier</ThingDef></descriptionHyperlinks>
    <label>psychic amplifier</label>
    <labelNoun>a psychic amplifier</labelNoun>
    <description>An installed psychic amplifier.</description>
    <spawnThingOnRemoved>PsychicAmplifier</spawnThingOnRemoved>
    <comps>
      <li Class="HediffCompProperties_RoyalImplant">
        <violationTriggerDescriptionKey>PsychicAmplifierViolationTrigger</violationTriggerDescriptionKey>
      </li>
    </comps>
    <initialSeverity>1</initialSeverity> <!-- Severity is bound to level of implant -->
    <minSeverity>0</minSeverity>
    <maxSeverity>6</maxSeverity>
    <stages>
      <li>
        <minSeverity>1</minSeverity>
        <statFactors>
          <PsychicEntropyMax>1.0</PsychicEntropyMax>
          <PsychicEntropyRecoveryRate>2</PsychicEntropyRecoveryRate>
        </statFactors>
      </li>
      <li>
        <minSeverity>2</minSeverity>
        <statFactors>
          <PsychicEntropyMax>1.3334</PsychicEntropyMax>
          <PsychicEntropyRecoveryRate>2.25</PsychicEntropyRecoveryRate>
        </statFactors>
      </li>
      <li>
        <minSeverity>3</minSeverity>
        <statFactors>
          <PsychicEntropyMax>1.6667</PsychicEntropyMax>
          <PsychicEntropyRecoveryRate>2.5</PsychicEntropyRecoveryRate>
        </statFactors>
      </li>
      <li>
        <minSeverity>4</minSeverity>
        <statFactors>
          <PsychicEntropyMax>2.0</PsychicEntropyMax>
          <PsychicEntropyRecoveryRate>2.75</PsychicEntropyRecoveryRate>
        </statFactors>
      </li>
      <li>
        <minSeverity>5</minSeverity>
        <statFactors>
          <PsychicEntropyMax>2.3334</PsychicEntropyMax>
          <PsychicEntropyRecoveryRate>3</PsychicEntropyRecoveryRate>
        </statFactors>
      </li>
      <li>
        <minSeverity>6</minSeverity>
        <statFactors>
          <PsychicEntropyMax>2.6667</PsychicEntropyMax>
          <PsychicEntropyRecoveryRate>3.25</PsychicEntropyRecoveryRate>
        </statFactors>
      </li>
    </stages>
  </HediffDef>

  <RecipeDef ParentName="SurgeryFlesh">
    <defName>DowngradePsychicAmplifier</defName>
    <label>extract psychic amplifier</label>
    <description>Extract a single psychic amplifier module from the brain.\n\nThis delicate brain surgery has a high chance of failure. It shouldn't be attempted without high-quality facilities - and only when necessary.\n\nIf the psychic amplifier is at level 1, it will be removed completely. Otherwise, it will be downgraded by 1 level. The extracted psychic amplifier can be re-installed later.</description>
    <descriptionHyperlinks><ThingDef>PsychicAmplifier</ThingDef></descriptionHyperlinks>
    <workerClass>Recipe_ChangeImplantLevel</workerClass>
    <jobString>Extracting a psychic amplifier.</jobString>
    <recipeUsers>
      <li>Human</li>
    </recipeUsers>
    <isViolation>true</isViolation>
    <workAmount>6000</workAmount>
    <skillRequirements>
      <Medicine>8</Medicine>
    </skillRequirements>
    <products>
      <PsychicAmplifier>1</PsychicAmplifier>
    </products>
    <ingredients>
      <li>
        <filter>
          <categories>
            <li>Medicine</li>
          </categories>
        </filter>
        <count>3</count>
      </li>
    </ingredients>
    <fixedIngredientFilter>
      <categories>
        <li>Medicine</li>
      </categories>
    </fixedIngredientFilter>
    <appliedOnFixedBodyParts>
      <li>Brain</li>
    </appliedOnFixedBodyParts>
    <hideBodyPartNames>true</hideBodyPartNames>
    <changesHediffLevel>PsychicAmplifier</changesHediffLevel>
    <hediffLevelOffset>-1</hediffLevelOffset>
    <surgerySuccessChanceFactor>0.85</surgerySuccessChanceFactor>
    <deathOnFailedSurgeryChance>0.15</deathOnFailedSurgeryChance>
  </RecipeDef>

</Defs>